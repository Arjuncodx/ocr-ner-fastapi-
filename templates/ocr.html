<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>OCR ‚Äî Image to Text</title>
<style>
  :root{
    --bg1:#0f172a; --bg2:#1e293b; --accent1:#4f46e5; --accent2:#06b6d4;
    --glass-border: rgba(255,255,255,0.12); --radius:14px;
  }
  html,body{ height:100%; margin:0; font-family: "Inter", system-ui, -apple-system, Roboto, Arial; color:#e6eefb;
    background: linear-gradient(-45deg,var(--bg1),var(--bg2),#0b1220);
    background-size: 400% 400%; animation: gradientShift 18s ease infinite;
  }
  @keyframes gradientShift{ 0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%} }

  header{ position:fixed; left:0; right:0; top:0; z-index:20; padding:18px 36px; display:flex; justify-content:space-between; align-items:center; background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-bottom:1px solid rgba(255,255,255,0.03); backdrop-filter: blur(6px); }
  .logo{ font-weight:800; font-size:18px; background: linear-gradient(90deg,var(--accent1),var(--accent2)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
  nav a{ color:#cfe6ff; margin-left:16px; text-decoration:none; font-weight:600; opacity:0.95; }

  main{ display:flex; justify-content:center; align-items:flex-start; padding:110px 20px 80px; min-height:100vh; box-sizing:border-box; }
  .container{ width:min(1180px,94%); display:grid; grid-template-columns: 1fr 420px; gap:36px; align-items:start; }

  .left{
    color:#eaf4ff;
  }
  h1{ margin:0 0 10px 0; font-size:2.4rem; line-height:1.05; }
  p.lead{ margin:0 0 18px 0; color:#bcd7ee; max-width:720px; }

  .card{ background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border-radius:16px; padding:28px; border:1px solid var(--glass-border); backdrop-filter: blur(12px); box-shadow: 0 20px 40px rgba(3,8,20,0.5); color:#eaf4ff; }

  /* Upload box */
  .drop-area{ border-radius:12px; padding:30px; display:flex; gap:18px; align-items:center; justify-content:center; min-height:160px; border:2px dashed rgba(255,255,255,0.06); background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); transition:transform .12s, box-shadow .12s; }
  .drop-area.dragover{ transform:translateY(-6px); box-shadow:0 24px 60px rgba(6,12,30,0.48); border-color:var(--accent2); background: rgba(255,255,255,0.03); }
  .drop-icon{ width:54px; height:54px; border-radius:12px; display:flex; align-items:center; justify-content:center; color:white; background: linear-gradient(90deg,var(--accent1),var(--accent2)); font-weight:900; box-shadow:0 10px 30px rgba(63,81,181,0.18); }

  .controls{ margin-top:14px; display:flex; gap:12px; align-items:center; }
  .btn{ padding:10px 16px; border-radius:10px; font-weight:800; border:none; cursor:pointer; }
  .btn.primary{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:white; box-shadow:0 10px 26px rgba(79,70,229,0.14); }
  .btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,0.06); color:#e6f0ff; }

  .note{ color:#a8c3df; font-size:13px; margin-top:12px; }

  footer{ text-align:center; padding:18px; color:#93a7c2; }

  @media (max-width:980px){ .container{ grid-template-columns: 1fr; } .card{ padding:20px; } }
</style>
</head>
<body>
<header>
  <div class="logo">OCR Model</div>
  <nav>
    <a href="/">Home</a>
    <a href="/ner">NER</a>
  </nav>
</header>

<main>
  <div class="container">
    <div class="left">
      <h1>Image ‚Üí Text (OCR)</h1>
      <p class="lead">Drop a photo, scan, or screenshot. The server will run preprocessing + OCR and give you a downloadable text file. Works best with clear, high-resolution images.</p>

      <div class="card">
        <h3 style="margin:0 0 8px 0">How it works</h3>
        <p style="margin:0 0 8px 0; color:#bcd7ee">Preprocess ‚Üí enhance ‚Üí Tesseract (primary) ‚Üí optional EasyOCR (ensemble). You can download the result as .txt.</p>
        <div style="display:flex; gap:8px; margin-top:12px;">
          <div style="background:rgba(255,255,255,0.03); padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);">CLAHE</div>
          <div style="background:rgba(255,255,255,0.03); padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);">Adaptive Threshold</div>
          <div style="background:rgba(255,255,255,0.03); padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);">Upscale</div>
        </div>
      </div>
    </div>

    <aside class="card" style="color:#0b1724; background:linear-gradient(180deg,#fff,#f8fbff);">
      <h2 style="color:#07203a; margin:0 0 8px 0">Upload image for OCR</h2>
      <div id="dropArea" class="drop-area" tabindex="0">
        <div class="drop-icon">üì∑</div>
        <div>
          <strong style="color:#07203a">Drop image here or click to select</strong>
          <div style="font-size:13px; color:#6b7280; margin-top:6px">PNG / JPG / WebP ‚Äî Max 50 MB</div>
        </div>
      </div>

      <input id="fileInput" type="file" accept="image/*" style="display:none" />

      <div class="controls">
        <button id="chooseBtn" class="btn primary">Choose Image</button>
        <button id="uploadBtn" class="btn primary" disabled>Upload & OCR</button>
        <button onclick="location.href='/'" class="btn ghost">Home</button>
      </div>

      <div id="status" class="note"></div>
    </aside>
  </div>
</main>

<footer>¬© {{ year }} OCR Model ‚Äî All rights reserved.</footer>

<script>
(function(){
  const drop = document.getElementById('dropArea'), fileInput = document.getElementById('fileInput');
  const chooseBtn = document.getElementById('chooseBtn'), uploadBtn = document.getElementById('uploadBtn');
  const status = document.getElementById('status');
  let curr=null, MAX_MB=50;

  chooseBtn.addEventListener('click', ()=>fileInput.click());
  drop.addEventListener('click', ()=>fileInput.click());
  fileInput.addEventListener('change', ()=>{ if(fileInput.files.length) handlePicked(fileInput.files[0]); });

  ['dragenter','dragover'].forEach(e=>drop.addEventListener(e,ev=>{ ev.preventDefault(); drop.classList.add('dragover'); }));
  ['dragleave','dragend','drop'].forEach(e=>drop.addEventListener(e,ev=>{ ev.preventDefault(); drop.classList.remove('dragover'); }));
  drop.addEventListener('drop', ev=>{ ev.preventDefault(); const f = ev.dataTransfer && ev.dataTransfer.files && ev.dataTransfer.files[0]; if(f) handlePicked(f); });

  function handlePicked(f){
    if(!f || !(f.type && f.type.startsWith('image/')) && !(/\.(png|jpe?g|webp)$/i).test(f.name)){ status.textContent='‚ùå Only image files allowed'; return; }
    if((f.size/(1024*1024))>MAX_MB){ status.textContent='‚ùå File too large'; return; }
    curr=f; status.textContent='Selected: '+f.name; uploadBtn.disabled=false;
  }

  uploadBtn.addEventListener('click', async ()=>{
    if(!curr){ status.textContent='‚ùå No file chosen'; return; }
    uploadBtn.disabled=true; chooseBtn.disabled=true; status.textContent='‚è≥ Uploading & OCR...';
    const fd=new FormData(); fd.append('file', curr);
    try{
      const resp = await fetch('/ocr/upload', { method:'POST', body: fd });
      const html = await resp.text();
      if(resp.ok){ document.open(); document.write(html); document.close(); return; }
      else { status.textContent='‚ùå Server error during OCR'; console.error(resp.status, html); }
    }catch(err){ status.textContent='‚ùå Network error'; }
    finally{ uploadBtn.disabled=false; chooseBtn.disabled=false; }
  });
})();
</script>
</body>
</html>
